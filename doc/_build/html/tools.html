<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Herramientas &mdash; documentación de EasyDev - 2.0.0</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="top" title="documentación de EasyDev - 2.0.0" href="index.html" />
    <link rel="next" title="Enviando correo" href="email.html" />
    <link rel="prev" title="Herramientas para depuración" href="debug.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="herramientas">
<h1>Herramientas<a class="headerlink" href="#herramientas" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="mostrar-informacion-del-pc">
<h2>Mostrar información del PC<a class="headerlink" href="#mostrar-informacion-del-pc" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="k">Sub</span> <span class="nf">ShowInfoPC</span><span class="p">()</span>
    <span class="n">util</span> <span class="o">=</span> <span class="n">createUnoService</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev&quot;</span><span class="p">)</span>

    <span class="c">&#39;Sistema operativo</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">OS</span><span class="p">)</span>

    <span class="c">&#39;Nombre de la aplicación</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">APP_NAME</span><span class="p">)</span>

    <span class="c">&#39;Versión de la aplicación</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">APP_VERSION</span><span class="p">)</span>

    <span class="c">&#39;Lenguaje</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">LANGUAGE</span><span class="p">)</span>

    <span class="c">&#39;Tamaño de la pantalla</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">getSizeScreen</span><span class="p">())</span>

    <span class="c">&#39; https://docs.python.org/3.3/library/platform.html</span>
    <span class="c">&#39; nombre de usuario,</span>
    <span class="c">&#39; nombre del pc</span>
    <span class="c">&#39; nombre del SO,</span>
    <span class="c">&#39; tipo de maquina,</span>
    <span class="c">&#39; nombre del procesador</span>
    <span class="c">&#39; Cadena de indentificación de la plataforma con la mayor cantidad de información posible</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">util</span><span class="p">.</span><span class="n">getInfoPC</span><span class="p">())</span>
<span class="k">End</span> <span class="k">Sub</span>
</pre></div>
</div>
</div>
<div class="section" id="hacer-una-pregunta">
<h2>Hacer una pregunta<a class="headerlink" href="#hacer-una-pregunta" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="k">Sub</span> <span class="nf">Pregunta</span><span class="p">()</span>
    <span class="n">util</span> <span class="o">=</span> <span class="n">createUnoService</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev&quot;</span><span class="p">)</span>

    <span class="n">titulo</span> <span class="o">=</span> <span class="s">&quot;Mi programa&quot;</span>
    <span class="n">mensage</span> <span class="o">=</span> <span class="s">&quot;¿Es fácil Python?&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">question</span><span class="p">(</span><span class="n">titulo</span><span class="p">,</span> <span class="n">mensaje</span><span class="p">)</span>

    <span class="c">&#39;Si pulsa SI, devuelve verdadero (True)</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

<span class="k">End</span> <span class="k">Sub</span>
</pre></div>
</div>
</div>
<div class="section" id="reemplazar-cadenas">
<h2>Reemplazar cadenas<a class="headerlink" href="#reemplazar-cadenas" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Reemplazar una cadena con argumentos</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="k">Sub</span> <span class="nf">RenderString</span><span class="p">()</span>
    <span class="n">util</span> <span class="o">=</span> <span class="n">createUnoService</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev&quot;</span><span class="p">)</span>

    <span class="c">&#39;Puedes usar una estructura NamedValue</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;Hola $data con $idioma, desde Basic 1!!&quot;</span>
    <span class="k">Dim</span> <span class="n">data1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">com</span><span class="p">.</span><span class="n">sun</span><span class="p">.</span><span class="n">star</span><span class="p">.</span><span class="n">beans</span><span class="p">.</span><span class="n">NamedValue</span>

    <span class="n">data1</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;data&quot;</span>
    <span class="n">data1</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&quot;Mundo&quot;</span>
    <span class="n">data1</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;idioma&quot;</span>
    <span class="n">data1</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&quot;Python&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">data1</span><span class="p">)</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="c">&#39;Usando estructura PropertyValue</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;Hola $data con $idioma, desde Basic 2!!&quot;</span>
    <span class="k">Dim</span> <span class="n">data2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">com</span><span class="p">.</span><span class="n">sun</span><span class="p">.</span><span class="n">star</span><span class="p">.</span><span class="n">beans</span><span class="p">.</span><span class="n">PropertyValue</span>

    <span class="n">data2</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;data&quot;</span>
    <span class="n">data2</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&quot;Mundo&quot;</span>
    <span class="n">data2</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;idioma&quot;</span>
    <span class="n">data2</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&quot;Python&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="c">&#39;Usando matrices</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;Hola $data con $idioma, desde Basic 3!!&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span> _
        <span class="n">Array</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">,</span> <span class="s">&quot;Mundo&quot;</span><span class="p">),</span> _
        <span class="n">Array</span><span class="p">(</span><span class="s">&quot;idioma&quot;</span><span class="p">,</span> <span class="s">&quot;Python&quot;</span><span class="p">)</span> _
    <span class="p">)</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">render</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
    <span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="k">End</span> <span class="k">Sub</span>
</pre></div>
</div>
</div>
<div class="section" id="formato">
<h2>Formato<a class="headerlink" href="#formato" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Más información y ejemplos <a class="reference external" href="https://pyformat.info/">aquí</a>.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="k">Sub</span> <span class="nf">FormatData</span><span class="p">()</span>
    <span class="n">util</span> <span class="o">=</span> <span class="n">createUnoService</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev&quot;</span><span class="p">)</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Hello {}&quot;</span><span class="p">,</span> <span class="s">&quot;World&quot;</span><span class="p">)</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Hello {} from {}&quot;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">,</span> <span class="s">&quot;PyUNO&quot;</span><span class="p">))</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Hello {1} from {0}&quot;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">,</span> <span class="s">&quot;PyUNO&quot;</span><span class="p">))</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;{:&lt;20}|{:^20}|{:&gt;20}&quot;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="s">&quot;Left&quot;</span><span class="p">,</span> <span class="s">&quot;Center&quot;</span><span class="p">,</span> <span class="s">&quot;Rigth&quot;</span><span class="p">))</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;{:_&lt;20}|{:-^20}|{:_&gt;20}&quot;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="s">&quot;Left&quot;</span><span class="p">,</span> <span class="s">&quot;Center&quot;</span><span class="p">,</span> <span class="s">&quot;Rigth&quot;</span><span class="p">))</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;{:d} {:f}&quot;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">3.1416</span><span class="p">))</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;{0:,.2f}&quot;</span><span class="p">,</span> <span class="mf">123456789.2468</span><span class="p">)</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Number {n1} y {n2}&quot;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="s">&quot;n1&quot;</span><span class="p">,</span> <span class="s">&quot;one&quot;</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span><span class="s">&quot;n2&quot;</span><span class="p">,</span> <span class="s">&quot;two&quot;</span><span class="p">)))</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;Number {n2} y {n1}&quot;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="s">&quot;n1&quot;</span><span class="p">,</span> <span class="s">&quot;one&quot;</span><span class="p">),</span> <span class="n">Array</span><span class="p">(</span><span class="s">&quot;n2&quot;</span><span class="p">,</span> <span class="s">&quot;two&quot;</span><span class="p">)))</span>

    <span class="n">my_date</span> <span class="o">=</span> <span class="n">createUnoStruct</span><span class="p">(</span><span class="s">&quot;com.sun.star.util.Date&quot;</span><span class="p">)</span>
    <span class="n">my_date</span><span class="p">.</span><span class="n">Day</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">my_date</span><span class="p">.</span><span class="n">Month</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">my_date</span><span class="p">.</span><span class="n">Year</span> <span class="o">=</span> <span class="mi">1974</span>
    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;{:%d-%B-%Y}&quot;</span><span class="p">,</span> <span class="n">my_date</span><span class="p">)</span>

    <span class="n">my_date</span> <span class="o">=</span> <span class="n">createUnoStruct</span><span class="p">(</span><span class="s">&quot;com.sun.star.util.DateTime&quot;</span><span class="p">)</span>
    <span class="n">my_date</span><span class="p">.</span><span class="n">Day</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">my_date</span><span class="p">.</span><span class="n">Month</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">my_date</span><span class="p">.</span><span class="n">Year</span> <span class="o">=</span> <span class="mi">1974</span>
    <span class="n">my_date</span><span class="p">.</span><span class="n">Hours</span> <span class="o">=</span> <span class="mi">13</span>
    <span class="n">my_date</span><span class="p">.</span><span class="n">Minutes</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="n">MsgBox</span> <span class="n">util</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">&quot;{:%Y-%b-%d %H:%M}&quot;</span><span class="p">,</span> <span class="n">my_date</span><span class="p">)</span>

<span class="k">End</span> <span class="k">Sub</span>
</pre></div>
</div>
</div>
<div class="section" id="archivos-y-directorios">
<h2>Archivos y directorios<a class="headerlink" href="#archivos-y-directorios" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Obtener una ruta desde configuración. Más información: <a class="reference external" href="http://api.libreoffice.org/docs/idl/ref/interfacecom_1_1sun_1_1star_1_1util_1_1XPathSettings.html">XPathSettings</a>.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">path</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getPath</span><span class="p">(</span><span class="s">&quot;Temp&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getPath</span><span class="p">(</span><span class="s">&quot;Work&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Obtener información de una ruta:</dt>
<dd><ol class="first last arabic simple">
<li>ruta base,</li>
<li>nombre del archivo,</li>
<li>nombre del archivo sin extensión,</li>
<li>extensión del archivo.</li>
</ol>
</dd>
</dl>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getPathInfo</span><span class="p">(</span><span class="s">&quot;/home/USER/log.txt&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Unir rutas</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">path</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">pathJoin</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="s">&quot;/home&quot;</span><span class="p">,</span> <span class="s">&quot;USER&quot;</span><span class="p">,</span> <span class="s">&quot;Documents&quot;</span><span class="p">))</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">pathJoin</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="s">&quot;/home/USER/Documents&quot;</span><span class="p">,</span> <span class="s">&quot;..&quot;</span><span class="p">,</span> <span class="s">&quot;Picture&quot;</span><span class="p">))</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p>Seleccionar directorio, de forma predeterminada, muestra la ruta de documentos del usuario</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">folder</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getFolder</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

<span class="c">&#39;Se puede establecer otra ruta de inicio</span>
<span class="n">folder</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getFolder</span><span class="p">(</span><span class="s">&quot;/home/USER&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
</pre></div>
</div>
<p>Seleccionar un solo archivo sin filtros.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">file</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getSelectedFiles</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="k">False</span><span class="p">,</span> <span class="n">Array</span><span class="p">())</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
<p>Seleccionar multiples archivos sin filtros.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">files</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getSelectedFiles</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="k">True</span><span class="p">,</span> <span class="n">Array</span><span class="p">())</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</pre></div>
</div>
<p>Seleccionar multiples archivos con un filtro.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">filters</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span> _
    <span class="n">Array</span><span class="p">(</span><span class="s">&quot;TXT&quot;</span><span class="p">,</span> <span class="s">&quot;*.txt&quot;</span><span class="p">),</span> _
    <span class="n">Array</span><span class="p">(</span><span class="s">&quot;LOG&quot;</span><span class="p">,</span> <span class="s">&quot;*.log&quot;</span><span class="p">),</span> _
    <span class="n">Array</span><span class="p">(</span><span class="s">&quot;CER | KEY&quot;</span><span class="p">,</span> <span class="s">&quot;*.cer;*.key&quot;</span><span class="p">)</span> _
<span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getSelectedFiles</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="k">True</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</pre></div>
</div>
<p>Obtener todos los archivos de un directorio de forma recursiva.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">files</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getFiles</span><span class="p">(</span><span class="s">&quot;/home/USER/Pictures&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</pre></div>
</div>
<p>Obtener todos los archivos de un directorio de forma recursiva con un filtro.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">files</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getFiles</span><span class="p">(</span><span class="s">&quot;/home/USER/Pictures&quot;</span><span class="p">,</span> <span class="s">&quot;jpg&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getFiles</span><span class="p">(</span><span class="s">&quot;/home/USER/Pictures&quot;</span><span class="p">,</span> <span class="s">&quot;png&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</pre></div>
</div>
<p>Abrir un archivo y leer su contenido.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">fileOpen</span><span class="p">(</span><span class="s">&quot;/home/USER/log.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="k">False</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Abrir un archivo regresando cada línea en una matriz.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">fileOpen</span><span class="p">(</span><span class="s">&quot;/home/USER/log.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="k">True</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Guardar información en un nuevo archivo.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="s">&quot;Hello World Python&quot;</span>
<span class="n">util</span><span class="p">.</span><span class="n">fileSave</span><span class="p">(</span><span class="s">&quot;/home/USER/test.txt&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="c">&#39;Verify</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">fileOpen</span><span class="p">(</span><span class="s">&quot;/home/mau/test.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Agregar información a un archivo</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="s">&quot;Hello World Python&quot;</span> <span class="o">&amp;</span> <span class="n">CHR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">fileSave</span><span class="p">(</span><span class="s">&quot;/home/USER/test2.txt&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="c">&#39;Verify</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">fileOpen</span><span class="p">(</span><span class="s">&quot;/home/USER/test2.txt&quot;</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ejecutar">
<h2>Ejecutar<a class="headerlink" href="#ejecutar" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ejecutar un comando y esperar la respuesta.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">res</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="s">&quot;ls&quot;</span><span class="p">,</span><span class="s">&quot;-la&quot;</span><span class="p">),</span> <span class="k">True</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
<p>Ejecutar un comando y <strong>no</strong> esperar respuesta.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">util</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">Array</span><span class="p">(</span><span class="s">&quot;gnome-calculator&quot;</span><span class="p">),</span> <span class="k">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="configuracion">
<h2>Configuración<a class="headerlink" href="#configuracion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Guadar un valor en el registro de configuración de LibreOffice, el valor se guarda
de forma persistente.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">util</span><span class="p">.</span><span class="n">setConfig</span><span class="p">(</span><span class="s">&quot;DefaultMail&quot;</span><span class="p">,</span> <span class="s">&quot;test@correolibre.net&quot;</span><span class="p">)</span>
<span class="c">&#39;Get value from config</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getConfig</span><span class="p">(</span><span class="s">&quot;DefaultMail&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>Es posible guardar matrices.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">util</span><span class="p">.</span><span class="n">setConfig</span><span class="p">(</span><span class="s">&quot;Matriz&quot;</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getConfig</span><span class="p">(</span><span class="s">&quot;Matriz&quot;</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="portapapeles">
<h2>Portapapeles<a class="headerlink" href="#portapapeles" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Obtener texto del portapapeles.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">value</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getClipboard</span><span class="p">()</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>Enviar texto al portapapeles.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">util</span><span class="p">.</span><span class="n">setClipboard</span><span class="p">(</span><span class="s">&quot;Hello World PyUNO!!&quot;</span><span class="p">)</span>
<span class="c">&#39;Verify</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getClipboard</span><span class="p">()</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="tiempo-unix">
<h2>Tiempo Unix<a class="headerlink" href="#tiempo-unix" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Más información: <a class="reference external" href="https://en.wikipedia.org/wiki/Unix_time">https://en.wikipedia.org/wiki/Unix_time</a></p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">epoch</span> <span class="o">=</span> <span class="n">util</span><span class="p">.</span><span class="n">getEpoch</span><span class="p">()</span>
<span class="n">util</span><span class="p">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">epoch</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="llamar-macros">
<h2>Llamar macros<a class="headerlink" href="#llamar-macros" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Más información: <a class="reference external" href="https://wiki.openoffice.org/wiki/Documentation/DevGuide/Scripting/Scripting_Framework_URI_Specification">Scripting Framework</a></p>
<p>Guarda la siguiente macro en:</p>
<p><code class="docutils literal"><span class="pre">/home/USER/.config/libreoffice/4/user/Scripts/python/mymacros.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">uno</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">show_time</span><span class="p">(</span><span class="n">cell</span><span class="p">):</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%c</span><span class="s">&#39;</span><span class="p">))</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
<p>Llamar a una macro Python (predeterminado) y esperar la respuesta.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">macro</span> <span class="o">=</span> <span class="n">createUnoStruct</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev.Macro&quot;</span><span class="p">)</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Library</span> <span class="o">=</span> <span class="s">&quot;mymacros&quot;</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;show_time&quot;</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">ThisComponent</span><span class="p">.</span><span class="n">CurrentSelection</span>
<span class="n">util</span><span class="p">.</span><span class="n">callMacro</span><span class="p">(</span><span class="n">macro</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/img005.png"><img alt="_images/img005.png" class="align-center" src="_images/img005.png" style="width: 400px;" /></a>
<p>Llamar a una macro Python y <strong>no</strong> esperar la respuesta.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">macro</span> <span class="o">=</span> <span class="n">createUnoStruct</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev.Macro&quot;</span><span class="p">)</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Library</span> <span class="o">=</span> <span class="s">&quot;mymacros&quot;</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;show_time&quot;</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Thread</span> <span class="o">=</span> <span class="k">True</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">ThisComponent</span><span class="p">.</span><span class="n">CurrentSelection</span>
<span class="n">util</span><span class="p">.</span><span class="n">callMacro</span><span class="p">(</span><span class="n">macro</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span>
</pre></div>
</div>
<p>Llamar a una macro en Basic</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">macro</span> <span class="o">=</span> <span class="n">createUnoStruct</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev.Macro&quot;</span><span class="p">)</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Library</span> <span class="o">=</span> <span class="s">&quot;EasyDevLib&quot;</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Module</span> <span class="o">=</span> <span class="s">&quot;Examples&quot;</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;HelloWorld&quot;</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Language</span> <span class="o">=</span> <span class="s">&quot;Basic&quot;</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Thread</span> <span class="o">=</span> <span class="k">False</span>
<span class="n">util</span><span class="p">.</span><span class="n">callMacro</span><span class="p">(</span><span class="n">macro</span><span class="p">,</span> <span class="n">Array</span><span class="p">())</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/img006.png"><img alt="_images/img006.png" class="align-center" src="_images/img006.png" style="width: 150px;" /></a>
</div>
<div class="section" id="timer">
<h2>Timer<a class="headerlink" href="#timer" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Guarda la siguiente macro en:</p>
<p><code class="docutils literal"><span class="pre">/home/USER/.config/libreoffice/4/user/Scripts/python/mymacros.py</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">uno</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">show_time</span><span class="p">(</span><span class="n">cell</span><span class="p">):</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">setString</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%c</span><span class="s">&#39;</span><span class="p">))</span>
    <span class="k">return</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">timer(NOMBRE_TIMER,</span> <span class="pre">SEGUNDOS,</span> <span class="pre">MACRO,</span> <span class="pre">ARGUMENTOS)</span></code></p>
<p>El nombre del timer es muy importante para que lo puedas detener. El timer
siempre se ejecuta en otro hilo de proceso.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">util</span> <span class="o">=</span> <span class="n">createUnoService</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev&quot;</span><span class="p">)</span>

<span class="c">&#39;Make data macro</span>
<span class="n">macro</span> <span class="o">=</span> <span class="n">createUnoStruct</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev.Macro&quot;</span><span class="p">)</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Library</span> <span class="o">=</span> <span class="s">&quot;mymacros&quot;</span>
<span class="n">macro</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;show_time&quot;</span>
<span class="c">&#39;Arguments</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">ThisComponent</span><span class="p">.</span><span class="n">CurrentSelection</span>
<span class="c">&#39;Timer name &quot;time&quot; and wait one second</span>
<span class="n">util</span><span class="p">.</span><span class="n">timer</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">macro</span><span class="p">,</span> <span class="n">Array</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span>
</pre></div>
</div>
<p>Detener un timer por su nombre</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="k">Sub</span> <span class="nf">StopTimer</span><span class="p">()</span>
    <span class="n">util</span> <span class="o">=</span> <span class="n">createUnoService</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev&quot;</span><span class="p">)</span>
    <span class="n">util</span><span class="p">.</span><span class="n">stopTimer</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>
</pre></div>
</div>
</div>
<div class="section" id="exportar-a-csv">
<h2>Exportar a CSV<a class="headerlink" href="#exportar-a-csv" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Establece un rango con datos y seleccionalo.</p>
<a class="reference internal image-reference" href="_images/img007.png"><img alt="_images/img007.png" class="align-center" src="_images/img007.png" style="width: 400px;" /></a>
<p>y esportarlo.</p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="n">util</span> <span class="o">=</span> <span class="n">createUnoService</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev&quot;</span><span class="p">)</span>

<span class="n">range</span> <span class="o">=</span> <span class="n">ThisComponent</span><span class="p">.</span><span class="n">CurrentSelection</span>

<span class="n">path</span> <span class="o">=</span> <span class="s">&quot;/home/USER/test.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">range</span><span class="p">.</span><span class="n">getDataArray</span><span class="p">()</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">Array</span><span class="p">()</span>

<span class="n">util</span><span class="p">.</span><span class="n">exportCSV</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<p>Cambiar opciones de exportación, más información en: <a class="reference external" href="https://docs.python.org/3.3/library/csv.html#csv.writer">https://docs.python.org/3.3/library/csv.html#csv.writer</a></p>
<div class="highlight-vbnet"><div class="highlight"><pre><span class="k">Dim</span> <span class="n">options</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">com</span><span class="p">.</span><span class="n">sun</span><span class="p">.</span><span class="n">star</span><span class="p">.</span><span class="n">beans</span><span class="p">.</span><span class="n">NamedValue</span>

<span class="n">util</span> <span class="o">=</span> <span class="n">createUnoService</span><span class="p">(</span><span class="s">&quot;org.universolibre.EasyDev&quot;</span><span class="p">)</span>

<span class="n">range</span> <span class="o">=</span> <span class="n">ThisComponent</span><span class="p">.</span><span class="n">CurrentSelection</span>

<span class="n">path</span> <span class="o">=</span> <span class="s">&quot;/home/USER/test.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">range</span><span class="p">.</span><span class="n">getDataArray</span><span class="p">()</span>
<span class="n">options</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&quot;delimiter&quot;</span>
<span class="n">options</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">Value</span> <span class="o">=</span> <span class="s">&quot;|&quot;</span>
<span class="n">util</span><span class="p">.</span><span class="n">exportCSV</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Tabla de Contenidos</a></h3>
  <ul>
<li><a class="reference internal" href="#">Herramientas</a><ul>
<li><a class="reference internal" href="#mostrar-informacion-del-pc">Mostrar información del PC</a></li>
<li><a class="reference internal" href="#hacer-una-pregunta">Hacer una pregunta</a></li>
<li><a class="reference internal" href="#reemplazar-cadenas">Reemplazar cadenas</a></li>
<li><a class="reference internal" href="#formato">Formato</a></li>
<li><a class="reference internal" href="#archivos-y-directorios">Archivos y directorios</a></li>
<li><a class="reference internal" href="#ejecutar">Ejecutar</a></li>
<li><a class="reference internal" href="#configuracion">Configuración</a></li>
<li><a class="reference internal" href="#portapapeles">Portapapeles</a></li>
<li><a class="reference internal" href="#tiempo-unix">Tiempo Unix</a></li>
<li><a class="reference internal" href="#llamar-macros">Llamar macros</a></li>
<li><a class="reference internal" href="#timer">Timer</a></li>
<li><a class="reference internal" href="#exportar-a-csv">Exportar a CSV</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="debug.html" title="capítulo anterior">Herramientas para depuración</a></li>
      <li>Next: <a href="email.html" title="próximo capítulo">Enviando correo</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tools.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Búsqueda rápida</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Ir a" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Introduzca los términos de búsqueda o un nombre de módulo, clase o función.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Mauricio Baeza.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="_sources/tools.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>